{"version":3,"sources":["../../src/pages/modal-transaction/modal-transaction.module.ts","../../src/pages/modal-transaction/modal-transaction.ts"],"names":[],"mappings":"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","file":"10.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {IonicPageModule} from 'ionic-angular';\nimport {ModalTransactionPage} from './modal-transaction';\nimport {BrMaskerModule} from \"brmasker-ionic-3\";\nimport {CurrencyPipe} from \"@angular/common\";\n\n@NgModule({\n  declarations: [\n    ModalTransactionPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ModalTransactionPage),\n    BrMaskerModule,\n  ],\n})\nexport class ModalTransactionPageModule {\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal-transaction/modal-transaction.module.ts","import {Component} from '@angular/core';\nimport {\n  AlertController,\n  IonicPage,\n  LoadingController,\n  NavController,\n  NavParams,\n  ToastController,\n  ViewController\n} from 'ionic-angular';\nimport {Api} from \"../../providers/api\";\nimport {AuthUserProvider} from \"../../providers/auth-user/auth-user\";\nimport {CurrencyPipe} from \"@angular/common\";\n\n/**\n * Generated class for the ModalTransactionPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-modal-transaction',\n  templateUrl: 'modal-transaction.html',\n})\nexport class ModalTransactionPage {\n\n  public moneda: any = null;\n  public userCountry: any = null;\n  public currency: any = null;\n  public country: any;\n\n  private transaction: any = {\n    amount_local: null, // monto de dinero a transferir\n    phone_user_des: null, // numero de telefono de la persona a la que se va a transferir\n    key_user: null,  // clave manual de la transacciòn 4 digitos\n    country_id: null,  // id del pais\n    coin_id: null,     // id de la moneda\n    code_phone: null,   // Codigo del celular en el pais\n  };\n\n\n  constructor(\n    public navParams: NavParams,\n    public viewCtrl: ViewController,\n    public toastCtrl: ToastController,\n    public loadingCtrl: LoadingController,\n    private api: Api,\n    private userProvider: AuthUserProvider,\n    public navCtrl: NavController,\n    public alertCtrl: AlertController,\n    private pipe: CurrencyPipe\n  ) {\n  }\n\n  ionViewWillLoad() {\n    this.userCountry = this.navParams.get('infoCountry');\n    this.moneda = this.navParams.get('moneda');\n    this.currency = this.navParams.get('currency');\n    this.transaction.country_id = this.navParams.get('pais_id');\n    this.transaction.code_phone = this.navParams.get('code_phohe');\n    this.transaction.coin_id = this.moneda.id;\n    this.country = this.navParams.get('country');\n  }\n\n  closeModal() {\n    this.viewCtrl.dismiss();\n  }\n\n  doTrasaction() {\n\n\n    let loading = this.loadingCtrl.create({\n      spinner: 'dots',\n    });\n    loading.present();\n    // let objtoSub = this.transaction;\n    // let amount = objtoSub.amount_local + \"\";\n    // let index = amount.indexOf(',');\n    // if (index > 0) {\n    // objtoSub.amount_local = this.transaction.amount_local.replace(new RegExp('\\\\.', 'g'), '');\n    //   objtoSub.amount_local = this.transaction.amount_local.replace(',', '.');\n    this.api.post('app/transaction', this.transaction, this.userProvider).then((data: any) => {\n      let toast = this.toastCtrl.create({\n        message: 'Transacción solicitada correctamente.',\n        showCloseButton: true,\n        closeButtonText: 'cerrar',\n        position: 'middle',\n      });\n      this.closeModal();\n      this.navCtrl.setPages([{page: 'HomePage'}, {page: 'TransactionResumePage', params: data}]);\n      loading.dismiss();\n      toast.present();\n    }).catch(error => {\n      loading.dismiss();\n      let mensaje = \"\";\n      error.error.forEach(data => {\n        mensaje += data.message + \"\\n\";\n      });\n      let toast = this.toastCtrl.create({\n        message: mensaje,\n        showCloseButton: true,\n        closeButtonText: 'cerrar',\n      });\n      toast.present();\n    });\n    // } else {\n    //   loading.dismiss();\n    //   let toast = this.toastCtrl.create({\n    //     message: 'Por favor ingrese un valor mayor a cero.',\n    //     showCloseButton: true,\n    //     closeButtonText: 'cerrar',\n    //     position: 'middle',\n    //   });\n    //   toast.present();\n    // }\n\n\n  }\n\n  confirmTrasaction() {\n    if (this.transaction.amount_local != null && this.transaction.phone_user_des != null && this.transaction.key_user != null && this.transaction.country_id != null && this.transaction.coin_id != null) {\n      if (this.transaction.key_user.length == 4 && this.transaction.phone_user_des > 9 && this.transaction.amount_local>0) {\n        let alerta = this.alertCtrl.create({\n          title: 'Confirmar transacción',\n          message: 'Destino: ' + this.transaction.phone_user_des + ' <br>  Monto:' +\n            this.getCurrency(this.transaction.amount_local) + \" \" + this.country.currency_code,\n          buttons: [\n            {\n              text: 'Cancelar',\n              role: 'cancel',\n            },\n            {\n              text: 'Solicitar',\n              handler: () => {\n                this.doTrasaction();\n              }\n            }\n          ]\n        });\n        alerta.present();\n      } else {\n        let toast = this.toastCtrl.create({\n          message: 'Número telefónico más de 9 digitos. Monto mayor a cero. Clave 4 dígitos',\n          showCloseButton: true,\n          closeButtonText: 'cerrar',\n          position: 'middle',\n        });\n        toast.present();\n      }\n    } else {\n      let toast = this.toastCtrl.create({\n        message: 'Todos los datos son obligatorios.',\n        showCloseButton: true,\n        closeButtonText: 'cerrar',\n        position: 'middle',\n      });\n      toast.present();\n    }\n  }\n\n  getCurrency(amount: number) {\n    return this.pipe.transform(amount, '$ ', true, '1.0-0');\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal-transaction/modal-transaction.ts"],"sourceRoot":""}